<!DOCTYPE html>
<html>

<head>
    <title>Calculator</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
    <div class="main">
        <form name="myForm">
            <input type="text" name="textview" class="textview" disabled>
        </form>
        <table>
            <tr>
                <td><input class="button symbol gray" type="button" onclick="SR('r')" id="r" value="√" disabled></td>
                <td><input class="button symbol gray" type="button" onclick="SR('s')" id="s" value="x²" disabled></td>
                <td><input class="button symbol gray" type="button" onclick="back()" value="⌫"></td>
                <td><input class="button symbol blue" type="button" onclick="insertOp('/')" value="÷"></td>
            </tr>
            <tr>
                <td><input class="button number gray" type="button" onclick="insertNum(7)" value="7"></td>
                <td><input class="button number gray" type="button" onclick="insertNum(8)" value="8"></td>
                <td><input class="button number gray" type="button" onclick="insertNum(9)" value="9"></td>
                <td><input class="button symbol blue" type="button" onclick="insertOp('*')" value="X"></td>
            </tr>
            <tr>
                <td><input class="button number gray" type="button" onclick="insertNum(4)" value="4"></td>
                <td><input class="button number gray" type="button" onclick="insertNum(5)" value="5"></td>
                <td><input class="button number gray" type="button" onclick="insertNum(6)" value="6"></td>
                <td><input class="button symbol blue" type="button" onclick="insertOp('-')" value="-"></td>
            </tr>
            <tr>
                <td><input class="button number gray" type="button" onclick="insertNum(1)" value="1"></td>
                <td><input class="button number gray" type="button" onclick="insertNum(2)" value="2"></td>
                <td><input class="button number gray" type="button" onclick="insertNum(3)" value="3"></td>
                <td><input class="button symbol blue" type="button" onclick="insertOp('+')" value="+"></td>
            </tr>
            <tr>
                <td><input class="button symbol gray" type="button" onclick="clean()" value="C"></td>
                <td><input class="button number gray" type="button" onclick="insertNum(0)" value="0"></td>
                <td><input class="button symbol gray" type="button" onclick="insertDec()" value="."></td>
                <td><input class="button symbol blue" type="button" onclick="equalTo()" value="="></td>
            </tr>
        </table>
    </div>
    <script> 
    var exp = '', number, decimal, equal, operator, allowSR = true;
var textview = document.forms['myForm']['textview'];

function insertNum(num) {
    if (equal){
        exp = num;
        textview.value = exp;
        number = true;
        equal = false;
    }
    else {
        exp = textview.value + num;
        textview.value =  exp;
        number = true;
    }
    if (operator) decimal = false;
    SR('a');
}

function insertOp(op) {
    textview.value = exp + op;
    operator = true;
    equal = false;
    allowSR = false;
    SR('a');
}

function insertDec() {
    if (number && ! decimal) {
        textview.value = exp + '.';
        decimal = true;
        operator = false;
    }
}

function equalTo() {
    if (exp) {
        exp = eval(exp);
        textview.value = exp;
        equal = true;
        decimal = false;
        number = false;
        allowSR = true;
        SR('a');
    }
}

function clean() {
    exp ='';
    textview.value = exp;
    decimal = false;
}

function back() {
    //exp = textview.value;
    textview.value = textview.value.substring(0, textview.value.length-1);
    //textview.value = exp;
}

function SR(x){
    if (x == 'r') {
        exp = Math.sqrt(exp);
        textview.value = exp;
    }
    else if (x == 's'){
        exp = exp * exp;
        textview.value = exp;
    }
    else if (x == 'a' && allowSR) {
        document.getElementById('r').disabled = false;
        document.getElementById('s').disabled = false;
    }
    else if (! allowSR) {
        document.getElementById('r').disabled = true;
        document.getElementById('s').disabled = true;
    }
}
    </script>
</body>

</html>
